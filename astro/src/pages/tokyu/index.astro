---
import Layout from '@layouts/Tokyu.astro';
import LayoutTop from '@layouts/content-body/Top.astro';
import TopNavCard from '@components/TopNavCard.astro';
import TopNavCardItem from '@components/TopNavCardItem.astro';
import TopUpdate from '@components/TopUpdate.astro';
import TopUpdateItem from '@components/TopUpdateItem.astro';
import AnchorButton from '@components/+phrasing/AnchorButton.astro';
import type { StructuredData } from '@type/types.js';
import { getEntryData } from '@util/update.ts';

const structuredData: StructuredData = {
	type: 'website',
	title: '東急電車資料室',
	description: '目蒲デハ1形から東急(新)3000系までの車両を研究する個人サイト',
};

const updateEntries = await getEntryData('tokyu.xml');
---

<Layout astroFilePath={Astro.self.moduleId} structuredData={structuredData} top={true}>
	<LayoutTop>
		<Fragment slot="nav">
			<TopNavCard heading="サイトコンテンツ">
				<TopNavCardItem title="車両データ" description="車歴表、編成表などの車両関連データ" linkHref="/tokyu/data/" />
				<TopNavCardItem title="車両機器" description="制御装置をはじめとする車両搭載機器" linkHref="/tokyu/machine/" />
				<TopNavCardItem title="台車" description="高性能車の台車バリエーション" linkHref="/tokyu/truck/" />
				<TopNavCardItem title="よもやま話" description="車両や車両機器の四方山話" linkHref="/tokyu/yomoyama/" />
				<TopNavCardItem title="自動放送" description="車内で流れる自動放送フレーズの紹介" linkHref="/tokyu/an/" />
				<TopNavCardItem title="設定器" description="行先設定器のボタン（ダイヤル）配列" linkHref="/tokyu/set/" />
				<TopNavCardItem title="鉄道本執筆" description="鉄道関係で執筆に関わった本の紹介と補足" linkHref="/tokyu/book/" />
			</TopNavCard>
		</Fragment>
		<Fragment slot="update">
			<TopUpdate id="update" heading="更新履歴">
				<Fragment slot="notice">
					<AnchorButton href="/tokyu/feed" type="atom" narrow={true}>新着フィード</AnchorButton>
				</Fragment>

				{updateEntries.map(({ updated, content }) => <TopUpdateItem slot="item" date={updated} set:html={content} />)}
			</TopUpdate>
		</Fragment>
	</LayoutTop>
</Layout>
