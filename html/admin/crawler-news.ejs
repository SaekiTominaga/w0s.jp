<section class="p-section -hdg-a">
	<div class="p-section__hdg">
		<h2>データ登録</h2>
	</div>

	<form action="<%= pagePathAbsoluteUrl %>" method="post" class="c-stack">
		<div class="p-form-grid">
			<div class="p-form-grid__group">
				<fieldset>
					<legend class="p-form-grid__legend">
						<label for="fc-url" class="c-label">URL <strong class="c-label-icon -required">必須</strong></label>
					</legend>
					<div class="p-form-grid__contents">
						<div class="c-form-controls">
							<%_ if (requestQuery.action_revise_preview || requestQuery.action_revise) { _%>
							<input type="url" class="c-input -full js-convert-trim" id="fc-url" name="url" value="<%= requestQuery.url %>" required="" readonly="" />
							<%_ } else { _%>
							<input type="url" class="c-input -full js-convert-trim" id="fc-url" name="url" value="<%= requestQuery.url %>" required="" />
							<%_ } _%>
						</div>
					</div>
				</fieldset>
			</div>
			<div class="p-form-grid__group">
				<fieldset>
					<legend class="p-form-grid__legend">
						<label for="fc-title" class="c-label">タイトル <strong class="c-label-icon -required">必須</strong></label>
					</legend>
					<div class="p-form-grid__contents">
						<div class="c-form-controls">
							<input class="c-input -full js-convert-trim" id="fc-title" name="title" value="<%= requestQuery.title %>" required="" />
						</div>
					</div>
				</fieldset>
			</div>
			<div class="p-form-grid__group">
				<fieldset>
					<legend class="p-form-grid__legend">
						<label for="fc-category" class="c-label">カテゴリー <strong class="c-label-icon -required">必須</strong></label>
					</legend>
					<div class="p-form-grid__contents">
						<div class="c-form-controls">
							<select class="c-select" id="fc-category" name="category">
								<%_ for (const category of categoryMaster) { _%> <%_ if (requestQuery.category === category.fk) { _%>
								<option value="<%= category.fk %>" selected=""><%= category.name %></option>
								<%_ } else { _%>
								<option value="<%= category.fk %>"><%= category.name %></option>
								<%_ } _%> <%_ } _%>
							</select>
						</div>
					</div>
				</fieldset>
			</div>
			<div class="p-form-grid__group">
				<fieldset>
					<legend class="p-form-grid__legend">
						<label for="fc-priority" class="c-label">優先度 <strong class="c-label-icon -required">必須</strong></label>
					</legend>
					<div class="p-form-grid__contents">
						<div class="c-form-controls">
							<select class="c-select" id="fc-priority" name="priority">
								<%_ for (const priority of priorityMaster) { _%> <%_ if (requestQuery.priority === priority.fk) { _%>
								<option value="<%= priority.fk %>" selected=""><%= priority.name %></option>
								<%_ } else { _%>
								<option value="<%= priority.fk %>"><%= priority.name %></option>
								<%_ } _%> <%_ } _%>
							</select>
						</div>
					</div>
				</fieldset>
			</div>
			<div class="p-form-grid__group">
				<fieldset>
					<legend class="p-form-grid__legend">ブラウザ</legend>
					<div class="p-form-grid__contents">
						<div class="c-form-controls">
							<label class="c-label -check">
								<%_ if (requestQuery.browser) { _%>
								<input type="checkbox" name="browser" value="1" checked="" />
								<%_ } else { _%>
								<input type="checkbox" name="browser" value="1" />
								<%_ } _%>
								<span class="c-label__text">ウェブブラウザでアクセスするか</span></label
							>
						</div>
					</div>
				</fieldset>
			</div>
			<div class="p-form-grid__group">
				<fieldset>
					<legend class="p-form-grid__legend">
						<label for="fc-selectorwrap" class="c-label">セレクター（包括） <strong class="c-label-icon -required">必須</strong></label>
					</legend>
					<div class="p-form-grid__contents">
						<div class="c-form-controls">
							<input class="c-input -full js-convert-trim" id="fc-selectorwrap" name="selectorwrap" value="<%= requestQuery.selector_wrap %>" required="" />
						</div>
					</div>
				</fieldset>
			</div>
			<div class="p-form-grid__group">
				<fieldset>
					<legend class="p-form-grid__legend">
						<label for="fc-selectordate" class="c-label">セレクター（日付） <strong class="c-label-icon -optional">任意</strong></label>
					</legend>
					<div class="p-form-grid__contents">
						<div class="c-form-controls">
							<input class="c-input -full js-convert-trim" id="fc-selectordate" name="selectordate" value="<%= requestQuery.selector_date %>" />
						</div>
					</div>
				</fieldset>
			</div>
			<div class="p-form-grid__group">
				<fieldset>
					<legend class="p-form-grid__legend">
						<label for="fc-selectorcontent" class="c-label">セレクター（内容） <strong class="c-label-icon -optional">任意</strong></label>
					</legend>
					<div class="p-form-grid__contents">
						<div class="c-form-controls">
							<input class="c-input -full js-convert-trim" id="fc-selectorcontent" name="selectorcontent" value="<%= requestQuery.selector_content %>" />
						</div>
					</div>
				</fieldset>
			</div>
		</div>

		<div class="c-form-controls -submit">
			<%_ if (requestQuery.action_revise_preview || requestQuery.action_revise) { _%>
			<p><button class="c-submit" name="actionrev" value="1">修正</button></p>
			<%_ } else { _%>
			<p><button class="c-submit" name="actionadd" value="1">登録</button></p>
			<%_ } _%>
		</div>
	</form>
</section>

<%_ for (const [categoryName, newsPageOfCategory] of newsPageList) { _%>
<section class="p-section -hdg-a">
	<div class="p-section__hdg">
		<h2><%= categoryName %></h2>
	</div>

	<table class="p-table p-admin-crawler-table">
		<thead>
			<tr>
				<td></td>
				<th scope="col">対象ページ</th>
				<th scope="col">優先</th>
				<th scope="col">🌐</th>
				<th scope="col">包括セレクター</th>
				<th scope="col">日付セレクター</th>
				<th scope="col">内容セレクター</th>
			</tr>
		</thead>
		<tbody>
			<%_ for (const newsPage of newsPageOfCategory) { _%>
			<tr>
				<td>
					<form action="<%= pagePathAbsoluteUrl %>" method="post">
						<p><input type="hidden" name="url" value="<%= newsPage.url %>" /></p>
						<p>
							<button name="actionrevpre" value="1" formmethod="get" class="c-submit -compact">修正</button>
							<button name="actiondel" value="1" is="w0s-confirm-button" data-message="削除しますか?" class="c-submit -compact">削除</button>
						</p>
					</form>
				</td>
				<td>
					<a href="<%= pagePathAbsoluteUrl %>/data?url=<%= newsPage.url %>"><%= newsPage.title %></a>
					<p style="margin-block-start: 0.5em; font-size: 80%">
						<a href="<%= newsPage.url %>" referrerpolicy="no-referrer"><%= newsPage.url %></a>
					</p>
				</td>
				<td><%= newsPage.priority %></td>
				<td><%_ if (newsPage.browser) { _%>✔<%_ } _%></td>
				<td><%= newsPage.selector_wrap %></td>
				<td><%= newsPage.selector_date %></td>
				<td><%= newsPage.selector_content %></td>
			</tr>
			<%_ } _%>
		</tbody>
	</table>
</section>
<%_ } _%>
